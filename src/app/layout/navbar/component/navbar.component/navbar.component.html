<nav class="bg-white shadow-lg sticky top-0 z-50 border-b border-blue-100">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      
      <!-- Logo -->
      <div class="flex-shrink-0">
        <a routerLink="/" class="flex items-center space-x-2 group">
        <img src="assets/empresa/TechStore-Logo.png" alt="TechStore Logo" class="w-16 h-16"/>
          <!-- <svg class="w-8 h-8 text-indigo-600 group-hover:text-indigo-700 transition-colors" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect>
            <rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect>
            <line x1="6" y1="6" x2="6.01" y2="6"></line>
            <line x1="6" y1="18" x2="6.01" y2="18"></line>
          </svg> -->
          <span class="text-xl font-bold text-gray-900 group-hover:text-indigo-700 transition-colors">
            TechStore
          </span>
        </a>
      </div>

      <!-- Desktop Navigation - Center -->
      <div class="hidden md:flex items-center space-x-1">
        <a 
          routerLink="/" 
          routerLinkActive="nav-active" 
          [routerLinkActiveOptions]="{exact: true}" 
          class="px-4 py-2 rounded-lg text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200 font-medium">
          Inicio
        </a>
        <a 
          routerLink="/catalogo" 
          routerLinkActive="nav-active"
          class="px-4 py-2 rounded-lg text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200 font-medium">
          Catálogo
        </a>
        <a 
          routerLink="/nosotros" 
          routerLinkActive="nav-active"
          class="px-4 py-2 rounded-lg text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200 font-medium">
          Acerca de Nosotros
        </a>
        <a 
          routerLink="/locales" 
          routerLinkActive="nav-active"
          class="px-4 py-2 rounded-lg text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200 font-medium">
          Locales
        </a>
      </div>

      <!-- Cart, User & Mobile Menu Button -->
      <div class="flex items-center space-x-2">
        <!-- Shopping Cart -->
        <a 
          routerLink="/carrito" 
          class="relative p-2 text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all duration-200">
          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          @if (cartItemsCount() > 0) {
            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">
              {{ cartItemsCount() }}
            </span>
          }
        </a>

        <!-- User Menu Desktop -->
        <div class="hidden md:block relative">
          @if (isLoggedIn()) {
            <!-- Usuario Logueado -->
            <button 
              (click)="toggleUserMenu()"
              class="flex items-center space-x-2 p-2 rounded-lg hover:bg-indigo-50 transition-all duration-200">
              <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-sm">
                {{ (currentUser()?.nombre || '').charAt(0).toUpperCase() }}{{ (currentUser()?.apellido || '').charAt(0).toUpperCase() }}
              </div>
              <svg class="w-4 h-4 text-gray-600" :class="{'rotate-180': isUserMenuOpen()}" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
              </svg>
            </button>

            <!-- Dropdown Menu -->
            @if (isUserMenuOpen()) {
              <div class="absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-2xl border border-gray-100 py-2 z-50">
                <!-- User Info Header -->
                <div class="px-4 py-3 border-b border-gray-100">
                  <p class="text-sm font-bold text-gray-900">
                    {{ currentUser()?.nombre }} {{ currentUser()?.apellido }}
                  </p>
                  <p class="text-xs text-gray-500 truncate">
                    {{ currentUser()?.correoElectronico }}
                  </p>
                  @if (isAdmin()) {
                    <span class="inline-block mt-1 px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-semibold rounded-full">
                      Administrador
                    </span>
                  }
                </div>

                <!-- Menu Items -->
                <div class="py-1">
                  @if (isAdmin()) {
                    <button 
                      (click)="navigateToAdmin()"
                      class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition-colors flex items-center space-x-2">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                      </svg>
                      <span>Panel de Administración</span>
                    </button>
                  }
                  
                  <a 
                    routerLink="/perfil" 
                    (click)="closeUserMenu()"
                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition-colors flex items-center space-x-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                    <span>Mi Perfil</span>
                  </a>

                  <a 
                    routerLink="/mis-pedidos" 
                    (click)="closeUserMenu()"
                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition-colors flex items-center space-x-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
                    </svg>
                    <span>Mis Pedidos</span>
                  </a>
                </div>

                <!-- Logout -->
                <div class="border-t border-gray-100 mt-1 pt-1">
                  <button 
                    (click)="onLogout()"
                    class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center space-x-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                    </svg>
                    <span>Cerrar Sesión</span>
                  </button>
                </div>
              </div>
            }
          } @else {
            <!-- Login Button -->
            <button 
              (click)="navigateToLogin()"
              class="flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"/>
              </svg>
              <span>Iniciar Sesión</span>
            </button>
          }
        </div>

        <!-- Mobile Menu Toggle -->
        <button 
          class="md:hidden p-2 text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all duration-200" 
          (click)="toggleMobileMenu()"
          [attr.aria-expanded]="isMobileMenuOpen()"
          aria-label="Toggle menu">
          @if (!isMobileMenuOpen()) {
            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
          } @else {
            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          }
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  @if (isMobileMenuOpen()) {
    <div class="md:hidden bg-white border-t border-gray-200 shadow-lg">
      <!-- User Info Mobile (si está logueado) -->
      @if (isLoggedIn()) {
        <div class="px-4 py-3 bg-gradient-to-r from-indigo-50 to-purple-50 border-b border-gray-200">
          <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold">
              {{ (currentUser()?.nombre || '').charAt(0).toUpperCase() }}{{ (currentUser()?.apellido || '').charAt(0).toUpperCase() }}
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-bold text-gray-900 truncate">
                {{ currentUser()?.nombre }} {{ currentUser()?.apellido }}
              </p>
              <p class="text-xs text-gray-600 truncate">
                {{ currentUser()?.correoElectronico }}
              </p>
            </div>
          </div>
          @if (isAdmin()) {
            <span class="inline-block mt-2 px-2 py-1 bg-indigo-100 text-indigo-700 text-xs font-semibold rounded-full">
              Administrador
            </span>
          }
        </div>
      }

      <!-- Navigation Links -->
      <div class="px-2 pt-2 pb-3 space-y-1">
        <a 
          routerLink="/" 
          routerLinkActive="mobile-nav-active" 
          [routerLinkActiveOptions]="{exact: true}" 
          class="block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200"
          (click)="closeMobileMenu()">
          Inicio
        </a>
        <a 
          routerLink="/catalogo" 
          routerLinkActive="mobile-nav-active" 
          class="block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200"
          (click)="closeMobileMenu()">
          Catálogo
        </a>
        <a 
          routerLink="/acerca-de" 
          routerLinkActive="mobile-nav-active" 
          class="block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200"
          (click)="closeMobileMenu()">
          Acerca de Nosotros
        </a>
        <a 
          routerLink="/locales" 
          routerLinkActive="mobile-nav-active" 
          class="block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200"
          (click)="closeMobileMenu()">
          Locales
        </a>
      </div>

      <!-- User Actions Mobile -->
      @if (isLoggedIn()) {
        <div class="px-2 pb-3 pt-2 border-t border-gray-200 space-y-1">
          @if (isAdmin()) {
            <a 
              routerLink="/admin" 
              class="flex items-center space-x-2 px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200"
              (click)="closeMobileMenu()">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
              </svg>
              <span>Panel Admin</span>
            </a>
          }
          <a 
            routerLink="/perfil" 
            class="flex items-center space-x-2 px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200"
            (click)="closeMobileMenu()">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            <span>Mi Perfil</span>
          </a>
          <a 
            routerLink="/mis-pedidos" 
            class="flex items-center space-x-2 px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200"
            (click)="closeMobileMenu()">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
            </svg>
            <span>Mis Pedidos</span>
          </a>
          <button 
            (click)="onLogout()"
            class="w-full flex items-center space-x-2 px-3 py-2 rounded-lg text-base font-medium text-red-600 hover:bg-red-50 transition-all duration-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
            </svg>
            <span>Cerrar Sesión</span>
          </button>
        </div>
      } @else {
        <div class="px-2 pb-3 pt-2 border-t border-gray-200">
          <button 
            (click)="navigateToLogin(); closeMobileMenu()"
            class="w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all duration-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"/>
            </svg>
            <span>Iniciar Sesión</span>
          </button>
        </div>
      }
    </div>
  }
</nav>
